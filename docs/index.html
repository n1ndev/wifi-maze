<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>My Product Control</title>
  </head>
  <body>
    <h1>My Product Control Page</h1>
    <p>Enter a command to send to your device:</p>
    <input type="text" id="commandInput" placeholder="Enter command">
    <button id="sendCommandButton">Send Command</button>
    <pre id="responseOutput"></pre>

    <script>
      // In a real application, retrieve the token securely after login.
      const SECRET_TOKEN = "MY_SECRET_TOKEN"; 

      document.getElementById("sendCommandButton").addEventListener("click", async () => {
        const cmd = document.getElementById("commandInput").value;
        // Access the device via its mDNS hostname
        const url = "http://qtpy.local/command?cmd=" + encodeURIComponent(cmd) +
                    "&token=" + encodeURIComponent(SECRET_TOKEN);
        try {
          const response = await fetch(url);
          const text = await response.text();
          document.getElementById("responseOutput").innerText = text;
        } catch (error) {
          document.getElementById("responseOutput").innerText = "Error: " + error;
        }
      });
    </script>
  </body>
</html>
